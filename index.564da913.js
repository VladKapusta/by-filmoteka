const e={cardsList:document.querySelector(".cards__list"),cardsItem:document.querySelector(".cards__item"),modal:document.querySelector(".backdrop"),closeModal:document.querySelector(".modal__close"),modalInform:document.querySelector(".wrraper-inform"),buttonModal:document.querySelector(".modal__buttons"),inputHeader:document.querySelector(".serch-films__input"),btnSearchFilm:document.querySelector(".serch-films__button"),btnEndPage:document.querySelector(".page__button-end"),btnNextPage:document.querySelector(".page__button-next"),btnsLibrary:document.querySelector(".lib__button"),libCardsList:document.querySelector(".library__cards")};class t{searchPopularFilms(){return fetch(`${this.API}trending/movie/day?api_key=${this.API_KEY}&page=${this.page}`).then((e=>e.json()))}searchFilmsToId(){return fetch(`${this.API}movie/${this.id}?api_key=${this.API_KEY}`).then((e=>e.json()))}searchFilmsToName(e){return fetch(`${this.API}search/movie?api_key=${this.API_KEY}&language=en-US&query=${e}`).then((e=>e.json()))}setFilmId(e){this.id=e}getId(){return this.id}pageIncr(){this.page+=1}pageDecr(){this.page-=1}setPage(e){this.page=e}getPage(){return this.page}constructor(){this.API="https://api.themoviedb.org/3/",this.API_KEY="f337b3367ff87f6c35f27ef8641676b2",this.page=1,this.id=""}}const n=[{id:28,name:"Action"},{id:12,name:"Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:99,name:"Documentary"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:14,name:"Fantasy"},{id:36,name:"History"},{id:27,name:"Horror"},{id:10402,name:"Music"},{id:9648,name:"Mystery"},{id:10749,name:"Romance"},{id:878,name:"Science Fiction"},{id:10770,name:"TV Movie"},{id:53,name:"Thriller"},{id:10752,name:"War"},{id:37,name:"Western"}];function a(e){const t={};for(const e of n)t[e.id]=e.name;const a=e.map((e=>t[e]));return a.length<3?a.join(", "):a.slice(1,3).concat("Other").join(", ")}const i=new t;let s;async function o(){s=await i.searchPopularFilms();const t=s.results.map((({original_title:e,genre_ids:t,release_date:n,poster_path:i,id:s})=>` <li class="cards__item" data-id="${s}">\n      <div class="film">\n        <div class="poster__wrraper">\n        <img src="https://image.tmdb.org/t/p/w500${i}" alt="" class="poster">\n        </div>\n        <div class="film__titel">\n        <h2 class="film__name">${e}</h2>\n        <div class="film__pre-info">\n        <p class="film__gener">${a(t)}</p>\n        <span>|</span>\n        <p class="film__reliz">${n.slice(0,4)}</p>\n        </div>\n        </div>\n        </div>\n        </li>`)).join(" ");e.cardsList.innerHTML+=t}o(),e.btnNextPage.addEventListener("click",(function(){i.pageIncr(),e.btnEndPage.classList.remove("page__button-end"),e.cardsList.innerHTML="",o()})),e.btnEndPage.addEventListener("click",(function(){if(i.pageDecr(),e.cardsList.innerHTML="",o(),1===i.getPage())return void e.btnEndPage.classList.add("page__button-end")}));document.querySelector(".page__list").addEventListener("click",(function(t){if("BUTTON"!==t.target.nodeName)return;let n=+t.target.textContent,a=document.querySelector(".btn-page-curr");e.btnEndPage.classList.remove("page__button-end"),a&&a.classList.remove("btn-page-curr");if(t.target.classList.add("btn-page-curr"),i.setPage(n),e.cardsList.innerHTML="",o(),"1"===n)return void e.btnEndPage.classList.add("page__button-end")})),e.closeModal.addEventListener("click",(function(){e.modal.classList.add("is-hidden")}));var l={save:(e,t)=>{try{const n=JSON.stringify(t);localStorage.setItem(e,n)}catch(e){console.error("Set state error: ",e.message)}},load:e=>{try{const t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}catch(e){console.error("Get state error: ",e.message)}}};const r=new t;let d,c;function m(e){if("BUTTON"!==e.target.nodeName)return;let t=e.target.textContent;const n=t.slice(7,t.length);let a=void 0===l.load(n)?[]:l.load(n);const{id:i,original_title:s,genres:o,overview:r,vote_average:c,vote_count:m,poster_path:_,release_date:u}=d;if(e.target.textContent===`remove ${n}`){e.target.textContent=`add to ${n}`;const t=a.filter((e=>e.id!==i));l.save(n,t)}a.map((e=>e.id)).includes(i)||(a.push({id:i,original_title:s,genres:o,overview:r,vote_average:c,vote_count:m,poster_path:_,release_date:u}),e.target.textContent=`remove ${n}`,l.save(n,a))}e.cardsList.addEventListener("click",(async function(t){c=t.target.closest(".cards__item").dataset.id,r.setFilmId(c),d=await r.searchFilmsToId(),""!==e.modalInform.textContent.trim()&&(e.modalInform.innerHTML="");(function({original_title:t,genres:n,overview:a,vote_average:i,vote_count:s,poster_path:o,popularity:l}){const r=n.map((e=>e.name)).slice(0,3).join(", "),d=`\n      <img src="https://image.tmdb.org/t/p/w500${o}" alt="" class="modal__poster" width="240" height="357">\n    </div>\n    <h2 class="modal__titel">${t}</h2>\n    <div class="modal__info-film">\n      <ul class="modal__info-list">\n          <li class="modal__info-item">\n              <p class="modal__vote">Vote / Votes</p>\n          </li>\n          <li class="modal__info-item">\n              <p class="modal__popularity">Popularity</p>\n          </li>\n          <li class="modal__info-item">\n              <p class="modal__origin-titel">Original Title</p>\n          </li>\n          <li class="modal__info-item">\n              <p class="modal__genre">Genre</p>\n          </li>\n      </ul>\n      <ul class="modal__value-list">\n          <li class="modal__value-item">\n              <p class="value-vote"><span>${i}</span>/ ${s}</p>\n          </li>\n          <li class="modal__value-item">\n              <p class="value-popularity">${l}</p>\n          </li>\n          <li class="modal__value-item">\n              <p class="value-origin-titel">${t}</p>\n          </li>\n          <li class="modal__value-item">\n              <p class="value-genre">${r} </p>\n          </li>\n      </ul>\n    </div>\n    <div class="modal__about">\n      <h2 class="modal__about-titel">About</h2>\n      <p class="modal__about-text">${a}</p>\n    </div>\n    <div class="modal__buttons">\n            <button class="modal__button button-watched">add to watched</button>\n            <button class="modal__button button-queue">add to queue</button>\n    </div>`;e.modalInform.innerHTML+=d})(d),e.modal.classList.remove("is-hidden");const n=document.querySelector(".modal__buttons");if(n.addEventListener("click",m),l.load("watched")&&l.load("queue")){const e=l.load("watched"),t=l.load("queue");e.some((e=>e.id===+c))&&(n.querySelector(".button-watched").textContent="remove watched"),t.some((e=>e.id===+c))&&(n.querySelector(".button-queue").textContent="remove queue")}}));const _=new t;e.btnSearchFilm.addEventListener("click",(async function(t){t.preventDefault(),e.cardsList.innerHTML="";const n=(await _.searchFilmsToName(e.inputHeader.value)).results.map((({original_title:e,genre_ids:t,release_date:n,poster_path:i,id:s})=>` <li class="cards__item" data-id="${s}">\n  <div class="film">\n    <div class="poster__wrraper">\n    <img src="https://image.tmdb.org/t/p/w500${i}" alt="" class="poster">\n    </div>\n    <div class="film__titel">\n    <h2 class="film__name">${e}</h2>\n    <div class="film__pre-info">\n    <p class="film__gener">${a(t)}</p>\n    <span>|</span>\n    <p class="film__reliz">${n.slice(0,4)}</p>\n    </div>\n    </div>\n    </div>\n    </li>`)).join(" ");e.cardsList.innerHTML+=n,e.inputHeader.value=""}));
//# sourceMappingURL=index.564da913.js.map
